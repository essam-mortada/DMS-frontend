<app-header></app-header>

<div class="container-fluid mt-3">
  <div class="row">
    <div class="col-12">
      <!-- Tab Navigation -->
      <ul class="nav nav-tabs mb-4">
        <li class="nav-item">
          <button class="nav-link"
                  [ngClass]="{ 'active': activeTab === 'dashboard' }"
                  (click)="setTab('dashboard')">
            Dashboard
          </button>
        </li>
        <li class="nav-item">
          <button class="nav-link"
                  [ngClass]="{ 'active': activeTab === 'workspaces' }"
                  (click)="setTab('workspaces')">
            Workspaces
          </button>
        </li>
        <li class="nav-item">
          <button class="nav-link"
                  [ngClass]="{ 'active': activeTab === 'documents' }"
                  (click)="setTab('documents')">
            Documents
          </button>
        </li>
      </ul>

      <!-- Dashboard Tab -->
      <div *ngIf="activeTab === 'dashboard'" class="tab-pane fade show active">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="h2 font-weight-bold">Dashboard</h2>
          <div class="btn-group">
            <button class="btn btn-primary mr-2" (click)="openCreateWorkspaceModal()">
              <i class="fas fa-plus mr-1"></i>
              New Workspace
            </button>
            <button class="btn btn-secondary" (click)="openUploadModal()">
              <i class="fas fa-upload mr-1"></i>
              Upload Document
            </button>
          </div>
        </div>

        <!-- Stats Cards -->
        <div class="row">
          <div class="col-md-3 mb-4">
            <div class="card">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                  <h5 class="card-title mb-0">Total Workspaces</h5>
                  <i class="fas fa-folder text-muted"></i>
                </div>
                <p class="h4 mt-2" id="totalWorkspaces">4</p>
              </div>
            </div>
          </div>

          <div class="col-md-3 mb-4">
            <div class="card">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                  <h5 class="card-title mb-0">Total Documents</h5>
                  <i class="fas fa-file text-muted"></i>
                </div>
                <p class="h4 mt-2" id="totalDocuments">6</p>
              </div>
            </div>
          </div>

          <div class="col-md-3 mb-4">
            <div class="card">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                  <h5 class="card-title mb-0">Storage Used</h5>
                  <i class="fas fa-upload text-muted"></i>
                </div>
                <p class="h4 mt-2">24.8 GB</p>
              </div>
            </div>
          </div>

          <div class="col-md-3 mb-4">
            <div class="card">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center">
                  <h5 class="card-title mb-0">Recent Uploads</h5>
                  <i class="fas fa-upload text-muted"></i>
                </div>
                <p class="h4 mt-2">12</p>
                <small class="text-muted">This week</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Workspaces Tab -->
      <div *ngIf="activeTab === 'workspaces'" class="tab-pane fade show active p-4 bg-white rounded">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="h2 font-weight-bold">Workspaces</h2>
          <button class="btn btn-primary" (click)="openCreateWorkspaceModal()">
            <i class="fas fa-plus mr-1"></i>
            New Workspace
          </button>
        </div>

        <div *ngIf="workspaces.length === 0" class="alert alert-info">
          No workspaces found
        </div>

        <div *ngIf="workspaces.length > 0">
          <p class="text-muted mb-4">Manage your workspaces and documents.</p>
          <app-workspace-list [workspaces]="workspaces" #workspaceList></app-workspace-list>
        </div>
      </div>

      <!-- Documents Tab -->
      <div *ngIf="activeTab === 'documents'" class="tab-pane fade show active">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="h2 font-weight-bold">All Documents</h2>
          <div class="d-flex">
            <select class="form-control mr-2" style="width: auto" id="workspaceFilter">
              <option value="">All Workspaces</option>
            </select>
            <button class="btn btn-primary" (click)="openUploadModal()">
              <i class="fas fa-upload mr-1"></i>
              Upload Document
            </button>
          </div>
        </div>

        <div class="card">
          <div class="card-body p-0">
            <div class="table-responsive">
              <table class="table table-striped table-hover mb-0">
                <thead class="thead-light">
                  <tr>
                    <th>Name</th>
                    <th>Type</th>
                    <th>Size</th>
                    <th>Upload Date</th>
                    <th>Workspace</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="documentsTable">
                  <!-- Documents will be populated by JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modals -->
<app-create-workspace-modal
  *ngIf="showCreateWorkspaceModal"
  (close)="closeCreateWorkspaceModal()"
  (onCreated)="workspaceList.fetch(); closeCreateWorkspaceModal()">
</app-create-workspace-modal>

<app-upload-modal
  *ngIf="showUploadModal"
  (close)="closeUploadModal()">
</app-upload-modal>
